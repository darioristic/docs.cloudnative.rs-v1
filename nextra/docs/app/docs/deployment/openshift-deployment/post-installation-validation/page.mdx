# Post-Installation Validation

Comprehensive validation procedures to ensure OpenShift cluster is properly configured and operational.

## Overview

Post-installation validation is a critical step to verify that the OpenShift cluster is functioning correctly, all components are healthy, and the environment meets enterprise requirements. This section provides detailed validation procedures and checklists.

## Pre-Validation Checklist

### Prerequisites
- [ ] Cluster installation completed successfully
- [ ] All nodes are in Ready state
- [ ] Core services are running
- [ ] Network connectivity established
- [ ] Storage is accessible

### Required Tools
- **OpenShift CLI (oc)**
  - Latest version installed
  - Proper authentication configured
  - Admin privileges available

- **Monitoring Tools**
  - Prometheus access
  - Grafana dashboards
  - Log aggregation tools

## Cluster Health Validation

### Node Status Verification
```bash
# Check all nodes status
oc get nodes

# Verify node conditions
oc describe nodes

# Check node resources
oc top nodes
```

**Expected Results:**
- All nodes show "Ready" status
- No scheduling issues
- Adequate resource availability

### Master Node Validation
```bash
# Check master node components
oc get pods -n openshift-kube-apiserver
oc get pods -n openshift-kube-controller-manager
oc get pods -n openshift-kube-scheduler

# Verify etcd health
oc get pods -n openshift-etcd
```

**Validation Criteria:**
- All master components running
- No pod restarts
- etcd cluster healthy

### Worker Node Validation
```bash
# Check worker node components
oc get pods -n openshift-kubelet
oc get pods -n openshift-kube-proxy

# Verify node resources
oc describe node <node-name>
```

**Validation Criteria:**
- Worker nodes operational
- Kubelet and proxy running
- Resources properly allocated

## Service Validation

### Core Services
```bash
# Check DNS service
oc get pods -n openshift-dns

# Verify ingress controller
oc get pods -n openshift-ingress

# Check monitoring stack
oc get pods -n openshift-monitoring
```

**Expected Results:**
- DNS resolution working
- Ingress controller active
- Monitoring services operational

### Application Services
```bash
# Check sample application deployment
oc new-app --name=test-app --image=nginx

# Verify application accessibility
oc get routes
oc get services
```

**Validation Steps:**
1. Deploy test application
2. Verify pod creation
3. Test service connectivity
4. Validate route access

## Network Validation

### Internal Networking
```bash
# Test pod-to-pod communication
oc run test-pod --image=busybox --rm -it --restart=Never -- nslookup kubernetes.default

# Verify service discovery
oc run test-pod --image=busybox --rm -it --restart=Never -- wget -qO- http://kubernetes.default
```

**Test Scenarios:**
- Pod-to-pod communication
- Service discovery
- DNS resolution
- Load balancing

### External Connectivity
```bash
# Test external access
oc run test-pod --image=busybox --rm -it --restart=Never -- wget -qO- https://www.google.com

# Verify ingress functionality
curl -H "Host: <ingress-host>" http://<ingress-ip>
```

**Validation Criteria:**
- External internet access
- Ingress controller working
- SSL/TLS termination
- Load balancer functionality

## Storage Validation

### Persistent Storage
```bash
# Test storage class availability
oc get storageclass

# Create test PVC
oc create -f - <<EOF
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: <storage-class>
EOF

# Verify PVC binding
oc get pvc test-pvc
```

**Validation Steps:**
1. Check storage classes
2. Create test PVC
3. Verify volume binding
4. Test volume mounting

### Storage Performance
```bash
# Deploy storage test pod
oc run storage-test --image=busybox --rm -it --restart=Never --command -- sh -c "
  dd if=/dev/zero of=/mnt/testfile bs=1M count=100
  dd if=/mnt/testfile of=/dev/null bs=1M
"
```

**Performance Metrics:**
- Write performance
- Read performance
- I/O latency
- Throughput

## Security Validation

### Authentication
```bash
# Test user authentication
oc login -u <username> -p <password>

# Verify user permissions
oc auth can-i create pods
oc auth can-i get secrets
```

**Security Checks:**
- User authentication working
- RBAC properly configured
- Permission boundaries enforced
- Token expiration working

### Network Security
```bash
# Test network policies
oc get networkpolicy

# Verify pod security
oc get pods -o yaml | grep securityContext
```

**Validation Criteria:**
- Network policies enforced
- Pod security contexts applied
- Service mesh security active
- TLS encryption working

## Monitoring Validation

### Metrics Collection
```bash
# Check Prometheus targets
oc get prometheus -n openshift-monitoring

# Verify metrics availability
curl -k https://prometheus-openshift-monitoring.apps.<cluster-domain>/api/v1/targets
```

**Monitoring Checks:**
- Prometheus collecting metrics
- All targets healthy
- Alert rules active
- Dashboard data available

### Logging
```bash
# Check logging stack
oc get pods -n openshift-logging

# Verify log collection
oc logs -n openshift-logging <log-collector-pod>
```

**Log Validation:**
- Log collection working
- Log aggregation active
- Search functionality available
- Retention policies enforced

## Performance Validation

### Resource Utilization
```bash
# Check cluster resource usage
oc top nodes
oc top pods --all-namespaces

# Monitor resource trends
oc adm top nodes --sort-by=cpu
oc adm top nodes --sort-by=memory
```

**Performance Metrics:**
- CPU utilization
- Memory usage
- Storage I/O
- Network throughput

### Load Testing
```bash
# Deploy load test application
oc new-app --name=load-test --image=nginx

# Scale application
oc scale deployment load-test --replicas=10

# Monitor performance
oc get hpa
```

**Load Test Scenarios:**
- Horizontal scaling
- Vertical scaling
- Resource limits
- Performance under load

## Backup Validation

### Backup Functionality
```bash
# Test etcd backup
oc adm etcd backup --backup-dir=/tmp/etcd-backup

# Verify backup integrity
oc adm etcd restore --backup-dir=/tmp/etcd-backup
```

**Backup Checks:**
- Backup creation successful
- Backup integrity verified
- Restore functionality working
- Backup retention policies

### Disaster Recovery
```bash
# Test cluster recovery
oc get clusteroperators
oc get clusterversion
```

**Recovery Validation:**
- Cluster operators healthy
- Version consistency
- Recovery procedures tested
- Failover scenarios validated

## Compliance Validation

### Security Compliance
```bash
# Run security scans
oc adm must-gather
oc adm inspect cluster

# Check compliance status
oc get compliancecheckresults
```

**Compliance Checks:**
- Security policies enforced
- Compliance standards met
- Vulnerability assessment
- Audit logging active

### Operational Compliance
```bash
# Verify operational procedures
oc get events --sort-by='.lastTimestamp'
oc get nodes -o wide
```

**Operational Validation:**
- Event monitoring active
- Node health consistent
- Service availability
- Performance metrics

## Validation Report

### Documentation Requirements
- **Validation Results**
  - Pass/fail status for each test
  - Performance metrics
  - Issues identified

- **Recommendations**
  - Configuration improvements
  - Performance optimizations
  - Security enhancements

- **Next Steps**
  - Production readiness assessment
  - Go-live preparation
  - Ongoing monitoring setup

### Sign-off Criteria
- [ ] All critical tests passed
- [ ] Performance meets requirements
- [ ] Security validation complete
- [ ] Monitoring operational
- [ ] Backup procedures tested
- [ ] Documentation complete

## Troubleshooting

### Common Issues
- **Node Not Ready**
  - Check node resources
  - Verify network connectivity
  - Review node logs

- **Service Failures**
  - Check pod status
  - Review service logs
  - Verify configuration

- **Storage Issues**
  - Check storage classes
  - Verify PVC binding
  - Review storage logs

### Diagnostic Commands
```bash
# Collect diagnostic information
oc adm must-gather

# Check cluster status
oc get clusteroperators
oc get clusterversion

# Review events
oc get events --sort-by='.lastTimestamp'
```

## Next Steps

After successful validation:

1. **Proceed to Documentation and Handover** - Prepare operational documentation
2. **Configure References and Templates** - Set up reusable resources
3. **Plan Production Deployment** - Prepare for go-live

This comprehensive validation ensures your OpenShift cluster is ready for production use.
